---

- name: Raw install python3 and python3-libselinux
  ansible.builtin.raw: dnf install -y python3 python3-libselinux

- name: Install sudo command
  ansible.builtin.dnf:
    name: sudo
    state: latest
    update_cache: yes

- name: Create {{ deploy_account }} user with random password
  ansible.builtin.user:
    name: '{{ deploy_account }}'
    group: '{{ deploy_group }}'
    comment: '{{ deploy_account }} is used to deploy'
    shell: /bin/bash
    password: "{{ lookup('password', '/dev/null chars=ascii_lowercase,ascii_uppercase,digits length=32') | password_hash('sha512', rounds=2048) }}"
    update_password: on_create

...
